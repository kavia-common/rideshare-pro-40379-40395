{"is_source_file": true, "format": "JavaScript (Node.js)", "description": "Main server file for RideShare Pro backend API, implementing user authentication, trip management, WebSocket communication, and route calculations.", "external_files": ["./utils/db.js", "./models/index.js", "./models/user.js", "./models/driver.js", "./models/trip.js"], "external_methods": ["connectMongo", "registerModels", "mongoose.model", "jwt.verify", "jwt.sign", "bcrypt.hash", "bcrypt.compare", "mongoose.findOne", "mongoose.create", "mongoose.findById", "mongoose.updateOne", "mongo.model"], "published": ["getJwtSecret", "authMiddleware", "osrmRoute"], "classes": [], "methods": [{"name": "getJwtSecret()", "description": "Retrieves JWT secret from environment variables, defaults to a development secret if none found.", "scope": "", "scopeKind": ""}, {"name": "authMiddleware(req, res, next)", "description": "Express middleware that verifies JWT token from Authorization header and attaches payload to request.", "scope": "", "scopeKind": ""}, {"name": "toPoint(lat, lng)", "description": "Converts latitude and longitude into a GeoJSON Point object.", "scope": "", "scopeKind": ""}, {"name": "osrmRoute(origin, destination)", "description": "Queries OSRM routing API for route details between two points.", "scope": "", "scopeKind": ""}, {"name": "simulateDriverMovement(ioInstance, tripId, driverId, pickup, destination)", "description": "Simulates driver movement along route segments and emits location updates via WebSocket.", "scope": "", "scopeKind": ""}], "calls": ["connectMongo", "registerModels", "mongoose.model", "jwt.verify", "jwt.sign", "bcrypt.hash", "bcrypt.compare", "fetch", "mongoose.findOne", "mongoose.create", "mongoose.findById", "mongoose.updateOne", "Trip.findOne", "Trip.create", "Driver.findOne", "Driver.updateOne", "Driver.findById", "Trip.find", "Trip.findById", "Trip.save", "io.to", "socket.join", "http.createServer", "server.listen"], "search-terms": ["server.js", "Express server", "Socket.IO", "JWT authentication", "Trip management", "Driver simulation", "OSRM routing", "RideShare API"], "state": 2, "file_id": 32, "knowledge_revision": 88, "git_revision": "5236db1cdf23d98d55cfdc468f5ebd29fd6a1d93", "revision_history": [{"72": ""}, {"88": "5236db1cdf23d98d55cfdc468f5ebd29fd6a1d93"}], "ctags": [{"_type": "tag", "name": "Driver", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^const Driver = mongoose.model('Driver');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "Trip", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^const Trip = mongoose.model('Trip');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "User", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^const User = mongoose.model('User');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "allowedOrigin", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^const allowedOrigin = process.env.REACT_APP_FRONTEND_URL || process.env.REACT_APP_BACKEND_URL ||/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^const app = express();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "authMiddleware", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^function authMiddleware(req, res, next) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res, next)"}, {"_type": "tag", "name": "getJwtSecret", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^function getJwtSecret() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "io", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^const io = new SocketIOServer(server, {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "lat", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^    const start = { lat: driver.currentLocation.coordinates[1], lng: driver.currentLocation.coor/", "language": "JavaScript", "kind": "property", "scope": "simulateDriverMovement.start", "scopeKind": "class"}, {"_type": "tag", "name": "lng", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^    const start = { lat: driver.currentLocation.coordinates[1], lng: driver.currentLocation.coor/", "language": "JavaScript", "kind": "property", "scope": "simulateDriverMovement.start", "scopeKind": "class"}, {"_type": "tag", "name": "osrmRoute", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^async function osrmRoute(origin, destination) {$/", "language": "JavaScript", "kind": "function", "signature": "(origin, destination)"}, {"_type": "tag", "name": "port", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^const port = Number(process.env.PORT || process.env.REACT_APP_PORT || 4000);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "server", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^const server = http.createServer(app);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "simulateDriverMovement", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^async function simulateDriverMovement(ioInstance, tripId, driverId, pickup, destination) {$/", "language": "JavaScript", "kind": "function", "signature": "(ioInstance, tripId, driverId, pickup, destination)"}, {"_type": "tag", "name": "start", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^    const start = { lat: driver.currentLocation.coordinates[1], lng: driver.currentLocation.coor/", "language": "JavaScript", "kind": "class", "scope": "simulateDriverMovement", "scopeKind": "class"}, {"_type": "tag", "name": "toPoint", "path": "/home/kavia/workspace/code-generation/rideshare-pro-40379-40395/backend_api_server/src/server.js", "pattern": "/^function toPoint(lat, lng) {$/", "language": "JavaScript", "kind": "function", "signature": "(lat, lng)"}], "hash": "86022ceee3e548bab0f30dfc725bb2f1", "format-version": 4, "code-base-name": "mobile_app_frontend", "filename": "backend_api_server/src/server.js", "fields": [{"name": "const start = { lat: driver.currentLocation.coordinates[1], lng: driver.currentLocation.coor/", "scope": "simulateDriverMovement.start", "scopeKind": "class", "description": "unavailable"}]}